    using SymPy
using GenericSVD
include("coeffcalc.jl")
function GreensInt(d,Al,p)
    x=Sym("x")
    if d==0
        return Al*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+exp(x/sqrt(Al))*Al*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-Al/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(x/sqrt(Al))*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))
    elseif d==1
        return (exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-exp(x/sqrt(Al))*Al*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+exp(p/sqrt(Al))*Al*p/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))
    elseif d==2
        return 2*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-2*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-2*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))*p^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+2*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+exp(x/sqrt(Al))*Al*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+2*Al^2*exp(p/sqrt(Al))/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-2*Al^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)
    elseif d==3
        return -6*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+6*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^2*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-6*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-6*Al^2*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+6*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+Al*exp(p/sqrt(Al))*p^3/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+6*Al^2*exp(p/sqrt(Al))*p/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))
    elseif d==4
        return -24*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+24*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-24*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))*p^4/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+12*Al^2*exp(p/sqrt(Al))*p^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+12*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-24*Al^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-Al*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-12*Al^2*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+24*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+24*Al^3*exp(p/sqrt(Al))/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-12*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-12*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+12*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^2*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)
    elseif d==5
        return -20*Al^2*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-120*Al^3*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+20*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^2*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-120*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-20*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+120*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^3*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+120*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-20*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-120*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+20*Al^2*exp(p/sqrt(Al))*p^3/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+120*Al^3*exp(p/sqrt(Al))*p/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+Al*exp(p/sqrt(Al))*p^5/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+20*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))
elseif d==6
return GI=720*Al^4*exp(p/sqrt(Al))/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+720*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-720*Al^4*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+30*Al^2*exp(p/sqrt(Al))*p^4/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+360*Al^3*exp(p/sqrt(Al))*p^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+Al*exp(p/sqrt(Al))*p^6/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-720*exp(x/sqrt(Al))*Al^4*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-360*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+30*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-Al*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-30*Al^2*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-360*Al^3*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+720*exp(x/sqrt(Al))*Al^4*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+360*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-720*Al^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+30*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^2*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+360*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^3*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-30*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-360*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-30*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))
elseif d==7
return 5040*Al^4*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+840*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-5040*Al^4*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-42*Al^2*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-42*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-840*Al^3*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-5040*exp(x/sqrt(Al))*Al^4*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-840*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))*p^7/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+42*Al^2*exp(p/sqrt(Al))*p^5/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+840*Al^3*exp(p/sqrt(Al))*p^3/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+5040*Al^4*exp(p/sqrt(Al))*p/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al*x^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+42*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^2*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+840*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^3*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+5040*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^4*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-5040*exp(x/sqrt(Al))*Al^4*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-840*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-42*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+42*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))
elseif d==8
return 20160*exp(x/sqrt(Al))*Al^4*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-1680*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-20160*exp(x/sqrt(Al))*Al^4*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-56*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-56*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-1680*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+56*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+1680*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-40320*Al^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-20160*Al^4*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+40320*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+40320*Al^5*exp(p/sqrt(Al))/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+40320*exp(x/sqrt(Al))*Al^5*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-56*Al^2*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-1680*Al^3*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*x^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-20160*Al^4*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))*p^8/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+56*Al^2*exp(p/sqrt(Al))*p^6/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+1680*Al^3*exp(p/sqrt(Al))*p^4/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+20160*Al^4*exp(p/sqrt(Al))*p^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-40320*exp(x/sqrt(Al))*Al^5*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-40320*Al^5*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+20160*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^4*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al*x^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+1680*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^3*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+56*(exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2*Al^2*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)
elseif d==9
return -362880*exp(x/sqrt(Al))*Al^5*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-3024*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+60480*Al^4*exp(p/sqrt(Al))*p^3/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-72*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-Al*x^9/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-3024*Al^3*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-362880*Al^5*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-60480*Al^4*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-72*Al^2*x^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-60480*exp(x/sqrt(Al))*Al^4*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+60480*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^4*x^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+72*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^2*x^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+72*Al^2*exp(p/sqrt(Al))*p^7/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+3024*Al^3*exp(p/sqrt(Al))*p^5/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-60480*exp(x/sqrt(Al))*Al^4*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^3/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+72*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x^9/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+362880*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^5*x/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+362880*Al^5*exp(p/sqrt(Al))*p/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+3024*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^3*x^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+60480*Al^4*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+3024*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+362880*Al^5*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))+Al*exp(p/sqrt(Al))*p^9/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-3024*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^5/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-72*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^7/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^9/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-362880*exp(x/sqrt(Al))*Al^5*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)
elseif d==10
return 1814400*exp(x/sqrt(Al))*Al^5*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+5040*exp(x/sqrt(Al))*Al^3*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+90*exp(x/sqrt(Al))*Al^2*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(x/sqrt(Al))*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-Al*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-3628800*Al^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+151200*exp(x/sqrt(Al))*Al^4*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+3628800*Al^6*exp(p/sqrt(Al))/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-1814400*Al^5*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+3628800*exp(x/sqrt(Al))*Al^6*exp(1/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-90*Al^2*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+1814400*Al^5*exp(p/sqrt(Al))*p^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-Al*x^10/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+3628800*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-151200*exp(x/sqrt(Al))*Al^4*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-1814400*exp(x/sqrt(Al))*Al^5*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-exp(x/sqrt(Al))*Al*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^10/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-5040*Al^3*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-151200*Al^4*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-151200*Al^4*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-5040*Al^3*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-1814400*Al^5*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(exp(x/sqrt(Al))*((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1))-90*Al^2*x^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-3628800*exp(x/sqrt(Al))*Al^6*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+90*Al^2*exp(p/sqrt(Al))*p^8/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-3628800*Al^6*exp(1/sqrt(Al))*(exp(p/sqrt(Al)))^2/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))-5040*exp(x/sqrt(Al))*Al^3*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)-90*exp(x/sqrt(Al))*Al^2*(exp(1/sqrt(Al)))^2*exp(p/sqrt(Al))*p^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+151200*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^4*x^4/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+90*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^2*x^8/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+5040*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^3*x^6/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+Al*exp(p/sqrt(Al))*p^10/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+151200*Al^4*exp(p/sqrt(Al))*p^4/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+5040*Al^3*exp(p/sqrt(Al))*p^6/(((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)*exp(x/sqrt(Al)))+1814400*(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al^5*x^2/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)+(exp(p/sqrt(Al)))^2*(exp(1/sqrt(Al)))^2*Al*x^10/((exp(1/sqrt(Al)))^2*(exp(p/sqrt(Al)))^2-1)
end


end


function totalGreen(d,n,Al,p)
    x=Sym("x")
    expr=0*x
    zz=coeffcalc(d,n)
    for j=1:length(zz)
        m(x)=GreensInt(j-1,Al,p)/Al
        expr=expr+zz[j]*m(x)
    end
    return expr
end

